"""
ç¬¬ä¸€é¢˜ï¼šæœºåœºç™»æœºå£åŠ¨æ€åˆ†é… (é—®é¢˜å»ºæ¨¡ä¸Žæ¨¡æ‹Ÿ - çº¢ç¯åŒº ðŸš¨)

ä¸»é¢˜: æ¨¡æ‹Ÿä¸€ä¸ªç®€åŒ–çš„æœºåœºç™»æœºå£åˆ†é…ç³»ç»Ÿã€‚

æœºåœºæœ‰ G ä¸ªç™»æœºå£ï¼Œç¼–å· 0 åˆ° G-1ã€‚N æž¶é£žæœºæŒ‰é¡ºåºè¯·æ±‚é™è½ï¼Œä¿¡æ¯å­˜å‚¨åœ¨åˆ—è¡¨ flights ä¸­ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ [request_time, required_gate_time]ï¼Œä»£è¡¨é£žæœºçš„è¯·æ±‚æ—¶é—´å’Œæ‰€éœ€çš„ç™»æœºå£å ç”¨æ—¶é•¿ã€‚

åˆ†é…è§„åˆ™å¦‚ä¸‹ï¼š

å½“ä¸€æž¶é£žæœºåœ¨ request_time è¯·æ±‚æ—¶ï¼Œç³»ç»Ÿä¼šæŸ¥æ‰¾å½“å‰ç©ºé—²çš„ç™»æœºå£ã€‚

å¦‚æžœæœ‰å¤šä¸ªç™»æœºå£ç©ºé—²ï¼Œä¼˜å…ˆåˆ†é…ç»™ç¼–å·æœ€å°çš„é‚£ä¸ªã€‚

å¦‚æžœæ²¡æœ‰ç™»æœºå£ç©ºé—²ï¼Œé£žæœºéœ€è¦æŽ’é˜Ÿç­‰å¾…ï¼Œç›´åˆ°æœ‰ç™»æœºå£ç©ºé—²ä¸ºæ­¢ã€‚ç­‰å¾…çš„é£žæœºä¸­ï¼Œè¯·æ±‚æ—¶é—´æœ€æ—©çš„ä¼˜å…ˆèŽ·å¾—ä¸‹ä¸€ä¸ªç©ºé—²çš„ç™»æœºå£ã€‚

ç™»æœºå£ä¸€æ—¦è¢«åˆ†é…ï¼Œä¼šä¸€ç›´è¢«å ç”¨ required_gate_time è¿™ä¹ˆé•¿çš„æ—¶é—´ã€‚

ä»»åŠ¡è¦æ±‚ï¼š ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ¨¡æ‹Ÿè¿™ä¸ªåˆ†é…è¿‡ç¨‹ï¼Œå¹¶è®¡ç®—å‡ºæ‰€æœ‰é£žæœºå®Œæˆç™»æœºå£å ç”¨ï¼ˆå³ç¦»å¼€ç™»æœºå£ï¼‰çš„æœ€æ™šæ—¶é—´ç‚¹ã€‚

ç¤ºä¾‹:

G = 1 (1ä¸ªç™»æœºå£)

flights = [[0, 5], [1, 3], [3, 4]] (é£žæœº0åœ¨t=0è¯·æ±‚ç”¨5å•ä½æ—¶é—´, é£žæœº1åœ¨t=1è¯·æ±‚ç”¨3, é£žæœº2åœ¨t=3è¯·æ±‚ç”¨4)

è¾“å‡º: 12

è¿‡ç¨‹è§£é‡Š:

t=0: é£žæœº0è¯·æ±‚ï¼Œç™»æœºå£0ç©ºé—²ã€‚åˆ†é…ç»™é£žæœº0ã€‚ç™»æœºå£0å°†åœ¨ 0 + 5 = 5 æ—¶åˆ»ç©ºé—²ã€‚

t=1: é£žæœº1è¯·æ±‚ï¼Œç™»æœºå£0è¢«å ç”¨ã€‚é£žæœº1è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚

t=3: é£žæœº2è¯·æ±‚ï¼Œç™»æœºå£0ä»è¢«å ç”¨ã€‚é£žæœº2è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚

t=5: ç™»æœºå£0ç©ºé—²ã€‚ç­‰å¾…é˜Ÿåˆ—ä¸­æœ‰é£žæœº1(t=1è¯·æ±‚)å’Œé£žæœº2(t=3è¯·æ±‚)ã€‚ä¼˜å…ˆåˆ†é…ç»™è¯·æ±‚æ›´æ—©çš„é£žæœº1ã€‚é£žæœº1å¼€å§‹ä½¿ç”¨ç™»æœºå£ã€‚ç™»æœºå£0å°†åœ¨ 5 + 3 = 8 æ—¶åˆ»ç©ºé—²ã€‚

t=8: ç™»æœºå£0ç©ºé—²ã€‚ç­‰å¾…é˜Ÿåˆ—ä¸­åªæœ‰é£žæœº2ã€‚åˆ†é…ç»™é£žæœº2ã€‚é£žæœº2å¼€å§‹ä½¿ç”¨ç™»æœºå£ã€‚ç™»æœºå£0å°†åœ¨ 8 + 4 = 12 æ—¶åˆ»ç©ºé—²ã€‚

t=12: æ‰€æœ‰é£žæœºéƒ½å·²å®Œæˆã€‚æœ€æ™šå®Œæˆæ—¶é—´æ˜¯12ã€‚

è€ƒçº²å¯¹åº”: é˜Ÿåˆ—/å †åº”ç”¨ï¼Œèµ„æºæŽ’é˜Ÿï¼Œè°ƒåº¦æ¨¡æ‹Ÿã€‚ è®­ç»ƒç›®æ ‡: å¼ºåˆ¶è¿ç”¨â€œäº”æ­¥å»ºæ¨¡æ³•â€ï¼Œç²¾ç¡®æ¨¡æ‹Ÿæ—¶é—´å’Œå¤šä¸ªèµ„æºï¼ˆç™»æœºå£ï¼‰çš„çŠ¶æ€ã€‚ä½ éœ€è¦è¿½è¸ªæ¯ä¸ªç™»æœºå£çš„ç©ºé—²æ—¶é—´ï¼Œä»¥åŠä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼ˆç”¨ä»€ä¹ˆæ•°æ®ç»“æž„æœ€é«˜æ•ˆï¼Ÿï¼‰ã€‚
"""

import heapq
from collections import defaultdict 

def gate_assign(G:int, flights:list[list[int]]) -> int:
  
  if not flights:
    return 0
  
  flights.sort(key=lambda x: x[0])
  gates = defaultdict()
  
  # [(request_time, required_gate_time)]
  on_wait = flights
  heapq.heapify(on_wait)
  
  deliver_flight = 0
  n = len(flights)
  
  while deliver_flight < n:
    
    for i in range(G):
      request_time, required_gate_time = heapq.heappop(on_wait)
      # å¦‚æžœæœ‰é€šé“ç©ºé—²
      if not gates[i]:
        gates[i] = (request_time, required_gate_time)
        deliver_flight += 1
    
    
  
  
  
  
  

  
      
         
         
       
       
    
  
  
    
 
  
    